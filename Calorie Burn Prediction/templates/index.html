<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calories Burnt Predictor</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <style>
        body {
            background-color: #f8f9fa;
        }
        h1 {
            color: #007bff;
        }
        #loader {
            display: none; /* Initially hidden */
            margin: 20px 0;
        }
        #result {
            font-size: 1.2rem;
            color: #28a745;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <h1 class="text-center mb-4">Calories Burnt Predictor</h1>
                <form id="calorieForm">
                    <div class="mb-3">
                        <label for="gender" class="form-label">Gender:</label>
                        <select class="form-select" id="gender" name="gender" required>
                            <option value="" disabled selected>Select your gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="age" class="form-label">Age:</label>
                        <input type="number" class="form-control" id="age" name="age" required min="1">
                    </div>
                    <div class="mb-3">
                        <label for="height" class="form-label">Height (cm):</label>
                        <input type="number" class="form-control" id="height" name="height" required min="1">
                    </div>
                    <div class="mb-3">
                        <label for="weight" class="form-label">Weight (kg):</label>
                        <input type="number" class="form-control" id="weight" name="weight" required min="1">
                    </div>
                    <div class="mb-3">
                        <label for="duration" class="form-label">Duration (minutes):</label>
                        <input type="number" class="form-control" id="duration" name="duration" required min="1">
                    </div>
                    <div class="mb-3">
                        <label for="heartRate" class="form-label">Heart Rate (bpm):</label>
                        <input type="number" class="form-control" id="heartRate" name="heartRate" required min="1">
                    </div>
                    <div class="mb-3">
                        <label for="bodyTemp" class="form-label">Body Temperature (Â°C):</label>
                        <input type="number" class="form-control" id="bodyTemp" name="bodyTemp" required min="30" max="45">
                    </div>
                    <button type="submit" class="btn btn-primary">Predict</button>
                </form>
                <div id="loader" class="text-center">
                    <div class="spinner-border" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
                <div id="result" class="mt-4"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const calorieForm = document.getElementById('calorieForm');
        const resultDiv = document.getElementById('result'); 
        const loader = document.getElementById('loader'); // Get the loader element

        calorieForm.addEventListener('submit', (event) => {
            event.preventDefault();

            // Show the loader
            loader.style.display = 'block';
            resultDiv.textContent = ''; // Clear previous result

            // Get input values
            const gender = document.getElementById('gender').value;
            const age = parseInt(document.getElementById('age').value);
            const height = parseInt(document.getElementById('height').value);
            const weight = parseInt(document.getElementById('weight').value);
            const duration = parseInt(document.getElementById('duration').value);
            const heartRate = parseInt(document.getElementById('heartRate').value);
            const bodyTemp = parseInt(document.getElementById('bodyTemp').value);

            // Prepare the data to be sent to the backend
            const data = {
                gender,
                age,
                height,
                weight,
                duration,
                heartRate,
                bodyTemp
            };

            // Send data to Flask backend
            fetch('/predict', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                // Hide the loader
                loader.style.display = 'none';

                // Check if there is an error in the response
                if (data.error) {
                    resultDiv.textContent = `Error: ${data.error}`;
                } else {
                    // Display the result from the backend
                    resultDiv.textContent = `Estimated calories burnt: ${data.calories_burnt}`;
                }
            })
            .catch(error => {
                console.error('Error:', error);
                loader.style.display = 'none'; // Hide the loader on error
                resultDiv.textContent = 'An error occurred while calculating calories.';
            });
        });
    </script>
</body>
</html>
